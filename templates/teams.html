<!doctype html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="{{ url_for('static',filename='styles/index.css') }}
"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static',filename='styles/tables.css') }}
"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static',filename='styles/tables_inputs.css') }}
"
    />
    <title>Équipes</title>
  </head>
  <body>
    <div id="heading_div">
      <h1>Équipes</h1>
    </div>
    <div id="body_div">
      <table>
        <tr>
          <th>Nom</th>
          <th>Portion</th>
          <th>Temps de jeu</th>
          <th>Priorité</th>
          <th>Type de terrain</th>
          <th>Paramètres</th>
        </tr>
        <tr>
          <td>Sixers</td>
          <td>Demi terrain</td>
          <td>7</td>
          <td>3</td>
          <td>Synthétique</td>
          <td>
            <a href="#" onclick="openPopup(this); return false;">Click here</a>
          </td>
        </tr>
        <tr>
          <td>The High Five</td>
          <td>Terrain entier</td>
          <td>10</td>
          <td>2</td>
          <td>Naturel</td>
          <td>
            <a href="#" onclick="openPopup(this); return false;">Click here</a>
          </td>
        </tr>
        <tr>
          <td>Gregarious Games</td>
          <td>Terrain entier</td>
          <td>15</td>
          <td>2</td>
          <td>Naturel</td>
          <td>
            <a href="#" onclick="openPopup(this); return false;">Click here</a>
          </td>
        </tr>
      </table>
    </div>
    <div id="footer_div">
      <input type="text" name="fname" />
      <select name="portions">
        <option value="whole">Terrain entier</option>
        <option value="half">Demi terrain</option>
        <option value="quarter">Quart de terrain</option>
      </select>
      <div class="numbers_entry_div" data-min="0" data-max="23">
        <button
          class="minus_button"
          onmousedown="startHold(this, minus)"
          onmouseup="stopHold()"
          onmouseleave="stopHold()"
        >
          -
        </button>
        <input type="text" value="0" readonly />
        <button
          class="plus_button"
          onmousedown="startHold(this, plus)"
          onmouseup="stopHold()"
          onmouseleave="stopHold()"
        >
          +
        </button>
      </div>
      <div class="numbers_entry_div" data-min="0" data-max="100">
        <button
          class="minus_button"
          onmousedown="startHold(this, minus)"
          onmouseup="stopHold()"
          onmouseleave="stopHold()"
        >
          -
        </button>
        <input type="text" value="0" readonly />
        <button
          class="plus_button"
          onmousedown="startHold(this, plus)"
          onmouseup="stopHold()"
          onmouseleave="stopHold()"
        >
          +
        </button>
      </div>
      <select name="portions">
        <option value="natural">Terrain en herbe</option>
        <option value="synthetic">Terrain synthétique</option>
      </select>
      <button>Submit</button>
    </div>

    <script>
      const channel = new BroadcastChannel("channel");
      function openPopup(element) {
        channel.postMessage(element.closest("tr").cells[0].textContent.trim());
      }

      let holdInterval;

      function startHold(button, callback) {
        callback(button);
        holdInterval = setInterval(() => callback(button), 150);
      }

      function stopHold() {
        clearInterval(holdInterval);
      }

      function minus(button) {
        const parent = button.parentElement;
        const input = parent.querySelector("input");
        const min = Number(parent.dataset.min) || 0;
        let value = Number(input.value);

        if (value > min) {
          input.value = --value;
        }
      }

      function plus(button) {
        const parent = button.parentElement;
        const input = parent.querySelector("input");
        const max = Number(parent.dataset.max);
        let value = Number(input.value);

        if (!max || value < max) {
          input.value = ++value;
        }
      }
    </script>
  </body>
</html>
